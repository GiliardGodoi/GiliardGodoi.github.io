<!doctype html>
<html lang="pt">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Gerando QR code com Python | Giliard Godoi
</title>
  <link rel="canonical" href="../../../articles/2022/gerando-qr-code-python/index.html">

    <link rel="apple-touch-icon" href="../../../apple-touch-icon.png" sizes="180x180">
    <link rel="icon" type="image/png" href="../../../favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="../../../manifest.json">
    <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="../../../theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="../../../theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="../../../theme/css/theme.css">
  <link rel="stylesheet" href="../../../theme/css/oldstyle.css">

  
  <meta name="description" content="Customizando a gera√ß√£o de QR codes">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="../../../">
        <img class="img-fluid rounded" src=../../../images/profile-park.png width=250 height=150 alt="Giliard Godoi">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="../../../">Giliard Godoi</a></h1>
      <p class="text-muted">Uma hist√≥ria sobre aprendizados</p>
      <ul class="list-inline">
            <li class="list-inline-item"><a href="../../../pages/sobre/">Sobre</a></li>
            <li class="list-inline-item"><a href="../../../pages/contato/">Contato</a></li>
            <li class=" list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/giliardgodoi" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/GiliardGodoi" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-linkedin-in" href="https://www.linkedin.com/in/giliardgodoi/" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-youtube" href="https://www.youtube.com/user/GiliardGodoi" target="_blank"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Gerando QR code com Python
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2022-09-27T00:00:00-03:00">
          <i class="fas fa-clock"></i>
          ter 27 setembro 2022
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="../../../category/utils">utils</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="../../../author/giliard-godoi.html">Giliard Godoi</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="../../../tag/qrcode">#qrcode</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h1>Criando QR codes com Python</h1>
<p>Por esses dias eu queria produzir um QR code para um link do <em>site</em> da C√¢mara de Vereadores de Santo Ant√¥nio da Platina - PR.</p>
<p>A maioria dos geradores dispon√≠veis na <em>internet</em> produzem imagens padr√µes, e seria interessante customizar esse QR code com as cores dominantes do <em>site</em> da institui√ß√£o. </p>
<p>Como bom programador Python eu utilizei uma biblioteca chamada <code>qrcode</code>. Ela est√° dispon√≠vel no PyPl (<a href="https://pypi.org/project/qrcode/">link</a>) e tamb√©m nesse reposit√≥rio: <a href="https://github.com/lincolnloop/python-qrcode">github.com/lincolnloop/python-qrcode</a>.</p>
<h2>Como funciona os QR codes</h2>
<p>Eu tentei encontrar algum artigo did√°tico sobre a gera√ß√£o de QR code e como eles funcionam, por√©m n√£o encontrei uma resposta satisfat√≥ria. </p>
<p>Por√©m, quis o destino (ou o algortimo do Twitter) que eu esbarrasse com essa <em>thread</em> que faz uma introdu√ß√£o bem legal e com v√°rias imagens ilustrativas.</p>
<p>Seria interessante dar uma olhada nessa <em>thread</em> antes de continuar lendo essa postagem.</p>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet" data-lang="en" data-dnt="true" data-theme="light">
    <p lang="en" dir="ltr">Ever wondered how a QR code works? <br>No, me neither but it&#39;s low-key fascinating.
    <br><br>(Warning, there is some extremely nerdy s*** here.üëá ) 
    <a href="https://t.co/SgQJVvhu0q">pic.twitter.com/SgQJVvhu0q</a> </p>&mdash; Dan Hollick üáøüá¶ (@DanHollick) 
        <a href="https://twitter.com/DanHollick/status/1570040185500626947?ref_src=twsrc%5Etfw">September 14, 2022</a>
</blockquote>

<p>Outra refer√™ncia interessante √© esse artigo da empresa respons√°vel pela cria√ß√£o do QR code, Denso Wave, contando um pouco da hist√≥ria da cria√ß√£o do QR code.</p>
<blockquote>
<p><a href="https://www.denso-wave.com/en/technology/vol1.html">QR code: development history</a></p>
</blockquote>
<h2>Instala√ß√£o</h2>
<p>Para instalar a biblioteca segui as instru√ß√µes apresentadas no reposit√≥rio. A adi√ß√£o do comando <code>[pil]</code> for√ßa a instala√ß√£o da biblioteca <a href="https://pypi.org/project/Pillow/">Pillow</a>, respons√°vel por gerar e trabalhar com alguns formatos de imagens (<code>.png</code> por exemplo).</p>
<div class="highlight"><pre><span></span><code><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">qrcode</span><span class="p">[</span><span class="n">pil</span><span class="p">]</span>
</code></pre></div>

<h2>Gerando QR Codes</h2>
<p>O meu objetivo √© produzir um QR code que direcione uma pessoa at√© a p√°gina <em>web</em> em que est√° dispon√≠vel a pauta das reuni√µes da C√¢mara Municipal.</p>
<p>Ent√£o, a <em>url</em> que eu vou codificar √© a seguinte:</p>
<div class="highlight"><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://sapl.santoantoniodaplatina.pr.leg.br/sessao/pauta-sessao&quot;</span>
</code></pre></div>

<p>Nesse tutorial vamos explorar a cria√ß√£o das imagens atrav√©s da classe <code>QRCode</code>, que fornece op√ß√µes algumas op√ß√µes avan√ßadas.</p>
<p>O c√≥digo abaixo apresenta uma forma de utilizar a classe <code>QRCode</code>, alguns par√¢mertos dela, e as fun√ß√µes necess√°rias para produzir um QR code.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">qrcode</span>

<span class="n">qr</span> <span class="o">=</span> <span class="n">qrcode</span><span class="o">.</span><span class="n">QRCode</span><span class="p">(</span>
    <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># est√° relacionado ao tamanho e quantidade de informa√ß√µes que o QR Code pode codificar</span>
    <span class="n">error_correction</span><span class="o">=</span><span class="n">qrcode</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ERROR_CORRECT_L</span><span class="p">,</span> <span class="c1"># Robustez e corre√ß√£o de erros de leitura</span>
    <span class="n">box_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="c1"># influencia no tamanho da imagem</span>
    <span class="n">border</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># borda da imagem at√© o in√≠cio do QR Code</span>
<span class="p">)</span>

<span class="n">qr</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1"># adiciona dados para serem codificados</span>

<span class="n">qr</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># se o par√¢metro `fit` est√° marcado como True</span>
<span class="c1"># a vers√£o do QR code pode ser alterada para suportar a codifica√ß√£o de uma </span>
<span class="c1"># quantidade maior de informa√ß√µes. Fa√ßa o seguinte teste: inicie o objeto `qr`</span>
<span class="c1"># com o par√¢metro `version=1` e o par√¢metro `fit` na fun√ß√£o `make` como False.</span>
<span class="c1"># √â esperado que uma exce√ß√£o seja gerada nessas condi√ß√µes.</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">()</span>
<span class="c1"># esse m√©todo possui os seguintes valores padr√µes</span>
<span class="c1"># img = qr.make_image(fill_color=&quot;black&quot;, back_color=&quot;white&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">))</span> 
<span class="n">img</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>&lt;class &#39;qrcode.image.pil.PilImage&#39;&gt;
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_9_1.png"></p>
<p>Observe que alterando o par√¢metro <code>error_correction</code> para <code>qrcode.constants.ERROR_CORRECT_H</code>altera-se o padr√£o da imagem. Isso significa tamb√©m que existe uma maior redund√¢ncia na codifica√ß√£o de informa√ß√µes que torna o QR code mais robusto a danos ou obstru√ß√µes que impe√ßam a leitura dos dados codificados.</p>
<div class="highlight"><pre><span></span><code><span class="n">qr</span> <span class="o">=</span> <span class="n">qrcode</span><span class="o">.</span><span class="n">QRCode</span><span class="p">(</span>
    <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">error_correction</span><span class="o">=</span><span class="n">qrcode</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ERROR_CORRECT_H</span><span class="p">,</span>
    <span class="n">box_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">border</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qr</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">qr</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>

<span class="n">img</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>&lt;class &#39;qrcode.image.pil.PilImage&#39;&gt;
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_11_1.png"></p>
<h3>Customiza√ß√£o</h3>
<p><code>qrcodes</code> oferece possibilidade de customizar as cores do QR code com a m√°scara <code>SolidFillColorMask</code>, ou op√ß√µes de gradiente, al√©m de inserir imagens no <em>background</em>.</p>
<p>Tamb√©m √© poss√≠vel escolher entre diferentes estilos de formas e desenhos para o QR code.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># factory para gerar uma imagem que poder√° ser transformada em .png e jpeg</span>
<span class="kn">from</span> <span class="nn">qrcode.image.styledpil</span> <span class="kn">import</span> <span class="n">StyledPilImage</span>

<span class="c1"># customiza√ß√£o de cores, gradientes, e imagem no background</span>
<span class="kn">from</span> <span class="nn">qrcode.image.styles.colormasks</span> <span class="kn">import</span> <span class="p">(</span><span class="n">SolidFillColorMask</span><span class="p">,</span>
                                            <span class="n">RadialGradiantColorMask</span><span class="p">,</span>
                                            <span class="n">SquareGradiantColorMask</span><span class="p">,</span>
                                            <span class="n">HorizontalGradiantColorMask</span><span class="p">,</span>
                                            <span class="n">VerticalGradiantColorMask</span><span class="p">,</span>
                                            <span class="n">ImageColorMask</span><span class="p">)</span>

<span class="c1"># customiza√ß√£o sobre a forma dos tra√ßos</span>
<span class="kn">from</span> <span class="nn">qrcode.image.styles.moduledrawers</span> <span class="kn">import</span> <span class="p">(</span><span class="n">RoundedModuleDrawer</span><span class="p">,</span>
                                               <span class="n">VerticalBarsDrawer</span><span class="p">,</span> 
                                               <span class="n">HorizontalBarsDrawer</span><span class="p">,</span>
                                               <span class="n">GappedSquareModuleDrawer</span><span class="p">,</span>
                                               <span class="n">CircleModuleDrawer</span><span class="p">)</span>

<span class="c1"># definindo um tom de azul para a cor do QR code</span>
<span class="n">custom_blue_color</span> <span class="o">=</span> <span class="n">SolidFillColorMask</span><span class="p">(</span><span class="n">front_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">107</span><span class="p">))</span>
</code></pre></div>

<p>Para saber como inst√¢nciar essas classes que oferecem diferentes op√ß√µes, d√™ um <code>help</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># help(RadialGradiantColorMask)</span>
<span class="c1"># help(SquareGradiantColorMask)</span>
<span class="c1"># help(HorizontalGradiantColorMask)</span>
<span class="c1"># help(VerticalGradiantColorMask)</span>
</code></pre></div>

<h4>RoundedModuleDrawer</h4>
<div class="highlight"><pre><span></span><code><span class="n">qr</span> <span class="o">=</span> <span class="n">qrcode</span><span class="o">.</span><span class="n">QRCode</span><span class="p">(</span><span class="n">error_correction</span><span class="o">=</span><span class="n">qrcode</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ERROR_CORRECT_L</span><span class="p">,</span> 
                   <span class="n">box_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  
                   <span class="n">border</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">qr</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">image_factory</span> <span class="o">=</span> <span class="n">StyledPilImage</span><span class="p">,</span> 
              <span class="n">module_drawer</span> <span class="o">=</span> <span class="n">RoundedModuleDrawer</span><span class="p">(),</span> 
              <span class="n">color_mask</span> <span class="o">=</span> <span class="n">custom_blue_color</span> <span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_17_0.png"></p>
<h4>CircleModuleDrawer</h4>
<div class="highlight"><pre><span></span><code><span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">image_factory</span> <span class="o">=</span> <span class="n">StyledPilImage</span><span class="p">,</span> 
              <span class="n">module_drawer</span> <span class="o">=</span> <span class="n">CircleModuleDrawer</span><span class="p">(),</span> 
              <span class="n">color_mask</span> <span class="o">=</span> <span class="n">custom_blue_color</span><span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_19_0.png"></p>
<h4>GappedSquareModuleDrawer</h4>
<div class="highlight"><pre><span></span><code><span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">image_factory</span> <span class="o">=</span> <span class="n">StyledPilImage</span><span class="p">,</span> 
              <span class="n">module_drawer</span> <span class="o">=</span> <span class="n">GappedSquareModuleDrawer</span><span class="p">(),</span> 
              <span class="n">color_mask</span> <span class="o">=</span> <span class="n">custom_blue_color</span> <span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_21_0.png"></p>
<h4>HorizontalBarsDrawer</h4>
<div class="highlight"><pre><span></span><code><span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">image_factory</span> <span class="o">=</span> <span class="n">StyledPilImage</span><span class="p">,</span> 
              <span class="n">module_drawer</span> <span class="o">=</span> <span class="n">HorizontalBarsDrawer</span><span class="p">(),</span> 
              <span class="n">color_mask</span> <span class="o">=</span> <span class="n">custom_blue_color</span><span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_23_0.png"></p>
<h4>VerticalBarsDrawer</h4>
<div class="highlight"><pre><span></span><code><span class="n">qr</span><span class="o">.</span><span class="n">make_image</span><span class="p">(</span><span class="n">image_factory</span> <span class="o">=</span> <span class="n">StyledPilImage</span><span class="p">,</span> 
              <span class="n">module_drawer</span> <span class="o">=</span> <span class="n">VerticalBarsDrawer</span><span class="p">(),</span> 
              <span class="n">color_mask</span> <span class="o">=</span> <span class="n">custom_blue_color</span> <span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="../../../images/gerando-qr-codes-com-Python_files/gerando-qr-codes-com-Python_25_0.png"></p>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="../../../authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="../../../archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="../../../categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="../../../tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>