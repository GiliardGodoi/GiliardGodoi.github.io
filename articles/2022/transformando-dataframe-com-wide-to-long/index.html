<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Transformando pandas dataframes com wide_to_long | Giliard Godoi
</title>
  <link rel="canonical" href="../../../articles/2022/transformando-dataframe-com-wide-to-long/index.html">

    <link rel="apple-touch-icon" href="../../../apple-touch-icon.png" sizes="180x180">
    <link rel="icon" type="image/png" href="../../../favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="../../../manifest.json">
    <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="../../../theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="../../../theme/css/pygments/manni.min.css">
  <link rel="stylesheet" href="../../../theme/css/theme.css">

  
  <meta name="description" content="Quando os nomes das colunas guardam informações que podem ser importantes">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="../../../">
        <img class="img-fluid rounded" src=../../../images/profile-pic.png width=250 height=150 alt="Giliard Godoi">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="../../../">Giliard Godoi</a></h1>
      <p class="text-muted">Machine Learning. Análise e visualização de dados. Inteligência Artificial. Computação Evolutiva.
Algoritmos Genéticos. Otimização combinatória. Teoria dos Grafos. Pythonista.
</p>
      <ul class="list-inline">
            <li class="list-inline-item"><a href="../../../pages/sobre/">Sobre</a></li>
            <li class="list-inline-item"><a href="../../../pages/projetos/">Projetos</a></li>
            <li class="list-inline-item"><a href="../../../pages/organizacao/">Organização</a></li>
            <li class="list-inline-item"><a href="../../../pages/contato/">Contato</a></li>
            <li class=" list-inline-item text-muted">|</li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/giliardgodoi" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/GiliardGodoi" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-linkedin-in" href="https://www.linkedin.com/in/giliardgodoi/" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-youtube" href="https://www.youtube.com/user/GiliardGodoi" target="_blank"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Transformando pandas dataframes com&nbsp;wide_to_long
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2022-07-26T00:00:00-03:00">
          <i class="fas fa-clock"></i>
          ter 26 julho 2022
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="../../../category/data-analysis">Data Analysis</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="../../../tag/python">#Python</a>,               <a href="../../../tag/pandas">#Pandas</a>,               <a href="../../../tag/dataframe-reshaping">#dataframe reshaping</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h2><span class="caps">TL</span>;<span class="caps">DR</span></h2>
<ul>
<li>Formato wide table</li>
<li>Formato long table</li>
<li>Para que serve a função <code>pd.wide_to_long</code></li>
<li>Parâmetros da função</li>
<li>Exemplos</li>
<li>Outros métodos e funções relacionados.</li>
</ul>
<p>Documentação: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html"><code>pd.wide_to_long</code></a></p>
<p>Exemplos mencionados no artigo também estão disponíveis no Google Collab.</p>
<h2>Introdução</h2>
<p>Este artigo discute a utilização da função <code>pd.wide_to_long</code> da biblioteca <a href="https://pandas.pydata.org/">Pandas</a>. 
“Wide tables” e “long tables” referem-se a como os dados estão organizados nas tabelas. Não sei se existe uma tradução melhor, mas eu vou adotar os conceitos de tabela no formato amplo (wide) e tabela no formato longo (long).</p>
<h2>Formato wide table (Formato amplo?)</h2>
<p>A organização da tabela no formato amplo é, possivelmente, o que mais naturalmente vem a mente quando pensamos em tabelas.</p>
<p>Esse formato possui as seguintes características:</p>
<ul>
<li>Cada linha corresponde a uma observação de um fenômeno (dados de uma pessoa, de uma transação bancária, etc.)</li>
<li>Cada coluna guarda o valor de um respectivo atributo dessa observação. Por exemplo, no caso de uma pessoa, poderíamos ter uma coluna para a altura, outra para o peso, outra para a data de nascimento.</li>
</ul>
<h2>Formato long table</h2>
<p>Já no formato longo os atributos de uma observação (isto é, o que seria as colunas) estão organizados como registros de uma tabela, isto é, distribuídos pelas linhas da tabela.
Um exemplo básico seria esse:</p>
<p><img alt="Imagem com exemplo de tabelas no formato longo e amplo" class="img-fluid" src="../../../images/long-wide-table-example.jpg"/></p>
<h2>Mas para que serve a função <code>pd.wide_to_long</code>?</h2>
<p>O próximo exemplo é baseado em um exemplo existente na documentação, mas eu inventei um contexto a mais para esses dados.</p>
<p>No mundo real, e pelas mais diferentes razões, os dados podem estar organizados nas mais variadas formas. </p>
<p>Imagine por exemplo, que por alguma razão, os nomes das colunas de uma tabela codificam uma informação importante, e queiramos utilizar essa informação como valores na nossa tabela.</p>
<p>Por exemplo, imagine a seguinte tabela com informações sobre a quantidade de vendas de dois produtos ‘A’ e ‘B’, durante cinco semanas dos anos de 2020 e 2021.</p>
<p>Os dados estão organizados na tabela com as seguintes colunas:</p>
<div class="highlight"><pre><span></span><code>    'A(weekly)-2020', 'A(weekly)-2021', 'B(weekly)-2020', 'B(weekly)-2021', 'week'
</code></pre></div>
<p>As colunas com informações do produto seguem o seguinte padrão: A ou B para identificar o produto seguido da expressão (weekly); um carácter de separação ‘-’; mais o valor que representa o ano (2020 ou 2021).</p>
<p>Os nomes das colunas podem ser divididos em duas partes que, para seguir a nomeação dada pela documentação, chamaremos de prefixo e sufixo.</p>
<p>Os prefixos seriam as expressões ‘A(weekly)’ e ‘B(weekly)’ que codificam a informação do tipo do produto.</p>
<p>Já os sufixos seriam os valores para os anos: 2020 e 2021.</p>
<p>Então, antes de seguir a leitura, note que identificamos nos nomes das colunas:</p>
<ul>
<li>Um prefixo: ‘A(weekly)’ e ‘B(weekly)’ </li>
<li>Um carácter de separação: ‘-’</li>
<li>Um sufixo: os valores </li>
</ul>
<h2>Parâmetros da função</h2>
<p>De acordo com a documentação, a função <code>pd.wide_to_long</code> possui os seguintes parâmetros:</p>
<ul>
<li>df é o dataframe a ser transformado.</li>
<li>stubnames (str ou uma lista) indica os valores dos prefixos presentes nos nomes das colunas, que serão utilizados para transformar o dataframe. Uma definição da palavra <em>stub</em> pode ser encontrada no <a href="https://dictionary.cambridge.org/dictionary/english/stub">dicionário Cambridge</a>;</li>
<li>i (str ou uma lista) indica as colunas que serão utilizadas com identificadores (id) das observações, essas colunas serão transformadas em índices do dataframe retornado.</li>
<li>j (str) : indica o nome da coluna que será criada com os valores identificados pelos sufixos </li>
<li>sep : indica o caractere de separação entre os prefixos e os sufixos dos nomes das colunas.</li>
<li>suffix: aceita uma expressão regular que será utilizada para a identificação dos sufixos; </li>
<li>O valor padrão é <code>\d+</code> que captura valores numéricos. </li>
<li>Esse parâmetro pode ser alterado para <code>\w+</code> que captura strings</li>
</ul>
<p>Particularmente, eu tenho a impressão que a biblioteca pandas poderia ser muito mais consistente na escolha dos nomes dos parâmetros. Porém, eu entendo que o desenvolvimento de qualquer software é uma atividade dinâmica que envolve diversas pessoas, durante um longo período de tempo, e ter essa consistência não é uma tarefa simples. </p>
<p>De qualquer forma, eu não acho que o nome desses parâmetros (i e j) sejam bons indicadores do que eles são. Repare que o parâmetro i pode receber uma string ou uma lista, mas o parâmetro <code>j</code> só recebe uma string, que é o nome da nova (e única) coluna criada. À primeira vista, isso pareceu meio confuso para mim.</p>
<h2>Exemplos de uso</h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'A(weekly)-2020'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                   <span class="s1">'A(weekly)-2021'</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
                   <span class="s1">'B(weekly)-2020'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
                   <span class="s1">'B(weekly)-2021'</span><span class="p">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
                   <span class="s1">'week'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>

<span class="n">df</span>
</code></pre></div>
<div id="df-14b1c82d-2b26-4bbd-a03a-9f527bc6e8c7">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A(weekly)-2020</th>
<th>A(weekly)-2021</th>
<th>B(weekly)-2020</th>
<th>B(weekly)-2021</th>
<th>week</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>10</td>
<td>11</td>
<td>5</td>
<td>32</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>23</td>
<td>77</td>
<td>44</td>
<td>56</td>
<td>2</td>
</tr>
<tr>
<th>2</th>
<td>59</td>
<td>34</td>
<td>33</td>
<td>43</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>90</td>
<td>8</td>
<td>22</td>
<td>12</td>
<td>4</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>12</td>
<td>1</td>
<td>67</td>
<td>5</td>
</tr>
<tr>
<th>5</th>
<td>8</td>
<td>45</td>
<td>32</td>
<td>44</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-14b1c82d-2b26-4bbd-a03a-9f527bc6e8c7')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-14b1c82d-2b26-4bbd-a03a-9f527bc6e8c7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-14b1c82d-2b26-4bbd-a03a-9f527bc6e8c7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Index(['A(weekly)-2020', 'A(weekly)-2021', 'B(weekly)-2020', 'B(weekly)-2021',
       'week'],
      dtype='object')
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Neste caso não seria necessário passar o valor do parâmetro `suffix` já que por padrão ele é '\d+'</span>

<span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'A(weekly)'</span><span class="p">,</span> <span class="s1">'B(weekly)'</span><span class="p">],</span> <span class="n">i</span><span class="o">=</span><span class="s1">'week'</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="s1">'year'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">'\d+'</span><span class="p">)</span>
</code></pre></div>
<div id="df-8a64cb72-21c9-4a46-9ccb-679f68e94dc0">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>A(weekly)</th>
<th>B(weekly)</th>
</tr>
<tr>
<th>week</th>
<th>year</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<th>2020</th>
<td>10</td>
<td>5</td>
</tr>
<tr>
<th>2</th>
<th>2020</th>
<td>23</td>
<td>44</td>
</tr>
<tr>
<th>3</th>
<th>2020</th>
<td>59</td>
<td>33</td>
</tr>
<tr>
<th>4</th>
<th>2020</th>
<td>90</td>
<td>22</td>
</tr>
<tr>
<th>5</th>
<th>2020</th>
<td>2</td>
<td>1</td>
</tr>
<tr>
<th>6</th>
<th>2020</th>
<td>8</td>
<td>32</td>
</tr>
<tr>
<th>1</th>
<th>2021</th>
<td>11</td>
<td>32</td>
</tr>
<tr>
<th>2</th>
<th>2021</th>
<td>77</td>
<td>56</td>
</tr>
<tr>
<th>3</th>
<th>2021</th>
<td>34</td>
<td>43</td>
</tr>
<tr>
<th>4</th>
<th>2021</th>
<td>8</td>
<td>12</td>
</tr>
<tr>
<th>5</th>
<th>2021</th>
<td>12</td>
<td>67</td>
</tr>
<tr>
<th>6</th>
<th>2021</th>
<td>45</td>
<td>44</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-8a64cb72-21c9-4a46-9ccb-679f68e94dc0')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-8a64cb72-21c9-4a46-9ccb-679f68e94dc0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8a64cb72-21c9-4a46-9ccb-679f68e94dc0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>Para transformar essa tabela do formato longo para o amplo (wide), podemos utilizar o método <code>unstack</code>, como mostra o exemplo a seguir.</p>
<div class="highlight"><pre><span></span><code><span class="n">df2</span> <span class="o">=</span> <span class="n">_</span> <span class="c1"># captura a resposta da célula anterior</span>

<span class="n">df2</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</code></pre></div>
<div id="df-40b3196e-ce35-4583-bf71-ed6b0b65821e">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr>
<th></th>
<th colspan="2" halign="left">A(weekly)</th>
<th colspan="2" halign="left">B(weekly)</th>
</tr>
<tr>
<th>year</th>
<th>2020</th>
<th>2021</th>
<th>2020</th>
<th>2021</th>
</tr>
<tr>
<th>week</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<td>10</td>
<td>11</td>
<td>5</td>
<td>32</td>
</tr>
<tr>
<th>2</th>
<td>23</td>
<td>77</td>
<td>44</td>
<td>56</td>
</tr>
<tr>
<th>3</th>
<td>59</td>
<td>34</td>
<td>33</td>
<td>43</td>
</tr>
<tr>
<th>4</th>
<td>90</td>
<td>8</td>
<td>22</td>
<td>12</td>
</tr>
<tr>
<th>5</th>
<td>2</td>
<td>12</td>
<td>1</td>
<td>67</td>
</tr>
<tr>
<th>6</th>
<td>8</td>
<td>45</td>
<td>32</td>
<td>44</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-40b3196e-ce35-4583-bf71-ed6b0b65821e')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-40b3196e-ce35-4583-bf71-ed6b0b65821e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-40b3196e-ce35-4583-bf71-ed6b0b65821e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<h3>Um exemplo avançado do uso do parâmetro <code>suffix</code></h3>
<p>A página da documentação menciona rapidamente um caso de uso alternativo para o uso parâmetro <code>suffix</code>. Na verdade, essa menção encontra-se na própria descrição do parâmetro <code>suffix</code>.</p>
<p>Imagine que temos dois produtos ‘A’ e ‘B’ e três canais de anúncio: <span class="caps">TV</span>, internet e rádio. Agora, digamos que estejamos interessados somente nos dados para dois canais de anúncio: <span class="caps">TV</span> e internet. </p>
<p>Podemos utilizar o poder das expressões regulares para transformar os dados referente a esses dois canais de vendas e deixar o terceiro intacto. </p>
<p>Neste caso, basta definir o parâmetro <code>suffix</code> com o seguinte valor <code>suffix=‘(tv|internet)’</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'A-tv'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                   <span class="s1">'A-internet'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                   <span class="s1">'B-tv'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                   <span class="s1">'B-internet'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                   <span class="s1">'B-radio'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                   <span class="s1">'id'</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                   <span class="p">})</span>
<span class="n">df3</span>
</code></pre></div>
<div id="df-170f846c-1846-4a75-a861-65ad48bb8e94">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A-tv</th>
<th>A-internet</th>
<th>B-tv</th>
<th>B-internet</th>
<th>B-radio</th>
<th>id</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>15</td>
<td>4</td>
<td>57</td>
<td>76</td>
<td>10</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>40</td>
<td>19</td>
<td>78</td>
<td>1</td>
<td>17</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>15</td>
<td>93</td>
<td>67</td>
<td>27</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<th>3</th>
<td>37</td>
<td>19</td>
<td>21</td>
<td>89</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>5</td>
<td>78</td>
<td>63</td>
<td>59</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-170f846c-1846-4a75-a861-65ad48bb8e94')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-170f846c-1846-4a75-a861-65ad48bb8e94 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-170f846c-1846-4a75-a861-65ad48bb8e94');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">],</span> <span class="n">i</span><span class="o">=</span><span class="s1">'id'</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="s1">'type'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">'(tv|internet)'</span><span class="p">)</span>
</code></pre></div>
<div id="df-41da72f8-dc3d-4f0f-ad82-89b7e05e30d8">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>B-radio</th>
<th>A</th>
<th>B</th>
</tr>
<tr>
<th>id</th>
<th>type</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<th>tv</th>
<td>10</td>
<td>15</td>
<td>57</td>
</tr>
<tr>
<th>1</th>
<th>tv</th>
<td>17</td>
<td>40</td>
<td>78</td>
</tr>
<tr>
<th>2</th>
<th>tv</th>
<td>1</td>
<td>15</td>
<td>67</td>
</tr>
<tr>
<th>3</th>
<th>tv</th>
<td>3</td>
<td>37</td>
<td>21</td>
</tr>
<tr>
<th>4</th>
<th>tv</th>
<td>59</td>
<td>5</td>
<td>78</td>
</tr>
<tr>
<th>0</th>
<th>internet</th>
<td>10</td>
<td>4</td>
<td>76</td>
</tr>
<tr>
<th>1</th>
<th>internet</th>
<td>17</td>
<td>19</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<th>internet</th>
<td>1</td>
<td>93</td>
<td>27</td>
</tr>
<tr>
<th>3</th>
<th>internet</th>
<td>3</td>
<td>19</td>
<td>89</td>
</tr>
<tr>
<th>4</th>
<th>internet</th>
<td>59</td>
<td>5</td>
<td>63</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-41da72f8-dc3d-4f0f-ad82-89b7e05e30d8')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-41da72f8-dc3d-4f0f-ad82-89b7e05e30d8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-41da72f8-dc3d-4f0f-ad82-89b7e05e30d8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>Note que a coluna ‘B-radio’ ainda persiste no resultado final. Se não a desejamos, bastar aplicar o método <code>drop</code> nessa coluna.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> 
                    <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">],</span> 
                    <span class="n">i</span><span class="o">=</span><span class="s1">'id'</span><span class="p">,</span> 
                    <span class="n">j</span><span class="o">=</span><span class="s1">'type'</span><span class="p">,</span> 
                    <span class="n">sep</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> 
                    <span class="n">suffix</span><span class="o">=</span><span class="s1">'(tv|internet)'</span><span class="p">)</span>
                <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'B-radio'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'columns'</span><span class="p">))</span>
</code></pre></div>
<div id="df-ff2d824c-0a98-4ee6-842c-5f342c1f91a2">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>A</th>
<th>B</th>
</tr>
<tr>
<th>id</th>
<th>type</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<th>tv</th>
<td>15</td>
<td>57</td>
</tr>
<tr>
<th>1</th>
<th>tv</th>
<td>40</td>
<td>78</td>
</tr>
<tr>
<th>2</th>
<th>tv</th>
<td>15</td>
<td>67</td>
</tr>
<tr>
<th>3</th>
<th>tv</th>
<td>37</td>
<td>21</td>
</tr>
<tr>
<th>4</th>
<th>tv</th>
<td>5</td>
<td>78</td>
</tr>
<tr>
<th>0</th>
<th>internet</th>
<td>4</td>
<td>76</td>
</tr>
<tr>
<th>1</th>
<th>internet</th>
<td>19</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<th>internet</th>
<td>93</td>
<td>27</td>
</tr>
<tr>
<th>3</th>
<th>internet</th>
<td>19</td>
<td>89</td>
</tr>
<tr>
<th>4</th>
<th>internet</th>
<td>5</td>
<td>63</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-ff2d824c-0a98-4ee6-842c-5f342c1f91a2')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-ff2d824c-0a98-4ee6-842c-5f342c1f91a2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ff2d824c-0a98-4ee6-842c-5f342c1f91a2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<h2>Dica para definir <code>sutbnames</code> com expressões regulares</h2>
<p>Um outro exemplo rapidamente mencionado na documentação, é utilizar expressões regulares para identificar os prefixos de forma programática.</p>
<p>Por exemplo, voltemos ao dataframe do primeiro exemplo.</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span>
</code></pre></div>
<div id="df-9ea3b5f4-e1f2-42ae-aaf9-2d469077ce6d">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="table-hover dataframe table-striped table">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A(weekly)-2020</th>
<th>A(weekly)-2021</th>
<th>B(weekly)-2020</th>
<th>B(weekly)-2021</th>
<th>week</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>10</td>
<td>11</td>
<td>5</td>
<td>32</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>23</td>
<td>77</td>
<td>44</td>
<td>56</td>
<td>2</td>
</tr>
<tr>
<th>2</th>
<td>59</td>
<td>34</td>
<td>33</td>
<td>43</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>90</td>
<td>8</td>
<td>22</td>
<td>12</td>
<td>4</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>12</td>
<td>1</td>
<td>67</td>
<td>5</td>
</tr>
<tr>
<th>5</th>
<td>8</td>
<td>45</td>
<td>32</td>
<td>44</td>
<td>6</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-9ea3b5f4-e1f2-42ae-aaf9-2d469077ce6d')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #<span class="caps">E8F0FE</span>;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #<span class="caps">E2EBFA</span>;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #<span class="caps">174EA6</span>;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #<span class="caps">D2E3FC</span>;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #<span class="caps">434B5C</span>;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #<span class="caps">FFFFFF</span>;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-9ea3b5f4-e1f2-42ae-aaf9-2d469077ce6d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9ea3b5f4-e1f2-42ae-aaf9-2d469077ce6d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>Poderíamos encontrar os valores dos prefixos utilizando o seguinte código:</p>
<div class="highlight"><pre><span></span><code><span class="n">stubnames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
    <span class="nb">set</span><span class="p">([</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">'[A-B]\(.*\)'</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">])</span>
<span class="p">)</span>

<span class="n">stubnames</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>['A(weekly)', 'B(weekly)']
</code></pre></div>
<h2>Outras funções para transformação de um dataframe</h2>
<p>A biblioteca pandas também oferece outras funções para alterar a estrutura de um dataframe conforme as nossas necessidades.</p>
<ul>
<li><code>pd.melt</code> - converte um dataframe do formato wide para o formato longo.</li>
<li><code>pd.pivot</code> - pode converter um dataframe do formato longo para wide.</li>
<li><code>dataframe.pivot_table</code> - possui quase a mesma função que a função <code>pd.pivot</code> porém realiza operações de agregação de dados por exemplo, calcular uma média, mediana, realizar uma contagem.</li>
<li><code>dataframe.stack</code> empilha colunas em índices;</li>
<li><code>dataframe.unstack</code> desempilha índices em colunas.</li>
</ul>
<h2>Conclusão</h2>
<p>Neste rápido tutorial, vimos o uso da função <code>pd.wide_to_long</code>. </p>
<p>Eu pessoalmente não conhecia essa função até bem pouco tempo atrás. Talvez porque o problema que essa função se propõe a resolver seja bem específico.</p>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
    <li class="list-inline-item"><a href="../../../archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="../../../categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="../../../tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>

</html>